{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/easy-debug-in-node/","result":{"data":{"site":{"siteMetadata":{"title":"学习随笔"}},"markdownRemark":{"id":"192c472f-93ea-5b0b-affc-970a28d32ca6","excerpt":"引言 作为前端工程师经常打交道的开发工具无非 IDE 编辑器 和 Chrome，在 Chrome 中调试是非常方便的，直接在 开发者工具的  栏打断点就可以了。那么，如果遇到需要写 node 相关的代码，比如 webpack 配置项，应该怎么调试来实现我们的需求呢？ VS Code 配置 在 VS Code…","html":"<h3>引言</h3>\n<p>作为前端工程师经常打交道的开发工具无非 IDE 编辑器 和 Chrome，在 Chrome 中调试是非常方便的，直接在 开发者工具的 <code class=\"language-text\">source</code> 栏打断点就可以了。那么，如果遇到需要写 node 相关的代码，比如 webpack 配置项，应该怎么调试来实现我们的需求呢？</p>\n<h3>VS Code 配置</h3>\n<p>在 VS Code 中单独有 debug 的菜单，需要指定 <code class=\"language-text\">launch.json</code> 文件，该文件为 VS Code 提供启动调试所需的各项配置。</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token comment\">// launch.json</span>\n<span class=\"token comment\">// 使用 IntelliSense 了解相关属性。</span>\n<span class=\"token comment\">// 悬停以查看现有属性的描述。</span>\n<span class=\"token comment\">// 欲了解更多信息，请访问: https://go.microsoft.com/fwlink/?linkid=830387</span>\n\n<span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"version\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"0.2.0\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"configurations\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"node\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"request\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"launch\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Launch via NPM\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"runtimeExecutable\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"npm\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"runtimeArgs\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"run-script\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"debug\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"cwd\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"${workspaceFolder}/envloader/mobile\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"port\"</span><span class=\"token operator\">:</span> <span class=\"token number\">9229</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>上面是我们项目的调试配置，<code class=\"language-text\">runtimeExecutable</code> 指明调试方式是 <code class=\"language-text\">npm</code> 方式，<code class=\"language-text\">runtimeArgs</code> 为执行调试传的参数，<code class=\"language-text\">cwd</code> 指定工作目录。</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token comment\">// package.json</span>\n\n<span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"debug\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"node --max_old_space_size=12288 --inspect-brk node_modules/webpack/bin/webpack.js --config build/webpack.dev.js --watch\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></code></pre></div>\n<p>注意 <code class=\"language-text\">debug</code> 脚本要传入 <code class=\"language-text\">--inspect-brk</code>，这样才可以开启 node 的调试功能。</p>\n<p>VS Code 调试菜单点击执行按钮，我们就可以愉快的调试 <code class=\"language-text\">webpack.dev.js</code> 代码了。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/bf7c368f2f8cd1745c96a0fc2f4c072d/a5701/webpack-plugin-debug.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.13823682837767%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsSAAALEgHS3X78AAABiElEQVQoz22SaW4bMQyF5yQFkjbj0UKtJLV6HMdB8qv3v045MbqlBT4IAkWR4ntaMrXN5icVZDWOFeSQRx+3mLvLE2JzqdlQIBTZuFRdLD41QY4W41ryPaXhAq/aK5MMcMG588DUjCsA5B1b3xRIaVRAJ4vgS6LLIlH0PWPXNioTNOAGRKG12FMcWYp6Vva4s1n8xckcz1wku+QLlt3nBoEhVuU4hAquKFcVFEldjWT/xaqTiX3ZTOZ4ls4+svMojwfPvYxZW+ZqA0LILhJE/BMNyYS+nHTCMEWGx9V8Xe2qgo00+nyb+37ez2P2ylwoEUbG9BOIWQMvm84onXkKVM+RprJkoVZ+Ke1KeYpmq8Z/+Jh5M1joKjMfNogHeZyAXZoRd09niRh/jP2h82/uvi7icPYz5fGwmi+P28OTee3j+/PlffRraTuVHPiT1HdsqIuzePONA39T4fgqJr2W8V6HrG91PFOvqZr/XdbSuY5bwimaS3l9fIZyAlrFnjtizJFKcvoJGecHF/R/IMINj8kAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"debug webpack plugin\"\n        title=\"debug webpack plugin\"\n        src=\"/static/bf7c368f2f8cd1745c96a0fc2f4c072d/799d3/webpack-plugin-debug.png\"\n        srcset=\"/static/bf7c368f2f8cd1745c96a0fc2f4c072d/00d96/webpack-plugin-debug.png 148w,\n/static/bf7c368f2f8cd1745c96a0fc2f4c072d/0b23c/webpack-plugin-debug.png 295w,\n/static/bf7c368f2f8cd1745c96a0fc2f4c072d/799d3/webpack-plugin-debug.png 590w,\n/static/bf7c368f2f8cd1745c96a0fc2f4c072d/2a3d6/webpack-plugin-debug.png 885w,\n/static/bf7c368f2f8cd1745c96a0fc2f4c072d/ae92f/webpack-plugin-debug.png 1180w,\n/static/bf7c368f2f8cd1745c96a0fc2f4c072d/a5701/webpack-plugin-debug.png 1917w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>可以看到，webpack 内部的数据结构尽收眼底。</p>\n<h3>Chrome 开发者工具风格</h3>\n<p>刚才的 <code class=\"language-text\">launch.json</code> 中，有 <code class=\"language-text\">port: 9229</code> 这个属性，我们可以在浏览器访问 <code class=\"language-text\">chrome://inspect</code> ，就能以我们熟悉的 chrome 风格来调试 node 程序了。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/81940091cc430cc930fd8a6e2c3f691f/3516d/chrome-debug.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 79.65023847376787%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAQABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAECBf/EABYBAQEBAAAAAAAAAAAAAAAAAAEAAv/aAAwDAQACEAMQAAAB21ZlRRH/xAAZEAACAwEAAAAAAAAAAAAAAAAAAQIQERL/2gAIAQEAAQUCxGROUNUj/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFxEAAwEAAAAAAAAAAAAAAAAAAAEREv/aAAgBAgEBPwGIyj//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAbEAABBAMAAAAAAAAAAAAAAAAAARAhUTFBof/aAAgBAQABPyFdxUnWZCaMD//aAAwDAQACAAMAAAAQG/8A/8QAFREBAQAAAAAAAAAAAAAAAAAAAQD/2gAIAQMBAT8Qlb//xAAVEQEBAAAAAAAAAAAAAAAAAAAAYf/aAAgBAgEBPxCSD//EABoQAQEBAAMBAAAAAAAAAAAAAAERAEFRkYH/2gAIAQEAAT8QLJ55dCNL4wxQv3UCFJ3gBJ9MEVJVd//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"debug in chrome\"\n        title=\"debug in chrome\"\n        src=\"/static/81940091cc430cc930fd8a6e2c3f691f/88218/chrome-debug.jpg\"\n        srcset=\"/static/81940091cc430cc930fd8a6e2c3f691f/7237a/chrome-debug.jpg 148w,\n/static/81940091cc430cc930fd8a6e2c3f691f/0cfdf/chrome-debug.jpg 295w,\n/static/81940091cc430cc930fd8a6e2c3f691f/88218/chrome-debug.jpg 590w,\n/static/81940091cc430cc930fd8a6e2c3f691f/3516d/chrome-debug.jpg 629w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h3>总结</h3>\n<p>调试程序能够帮助我们对代码有更深刻的了解，能够提供运行时的执行上下文、调用栈等信息。此外，在调试线上混淆后的代码时，对各种 a、o、f 等难以理解的变量名参数名也能通过运行时的变量数据轻易分析出代码的基本逻辑。</p>","frontmatter":{"title":"vscode 调试 node.js","date":"September 14, 2020","description":"本文将介绍 VS Code 调试 node.js 的小技巧。"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"tags":["debug"],"slug":"/easy-debug-in-node/","previous":{"excerpt":"背景 最近在公司做移动端项目优化的工作，目前主要的重心放在了打包体积优化上。目前项目中采用了 webpack 4，实际上已经为我们提供了诸多方便的配置能力进行打包优化。 抽离 webpack 运行时代码 将 optimization.runtimeChunk 设置为 true…","fields":{"slug":"/webpack-inline-runtime-chunk/"},"frontmatter":{"date":"October 13, 2020","description":"将 webpack 运行时代码抽到单独的文件，并内嵌至 index.html 中","title":"webpack 内联 runtimeChunk 至index.html","tags":["webpack"]}},"next":{"excerpt":"背景 最近几个月的工作都以移动端为主，主要的工作内容是将 PC 端已有的核心业务移植到 Mobile…","fields":{"slug":"/watch-external-files-webpack-plugin/"},"frontmatter":{"date":"September 10, 2020","description":"本文将介绍当需要根据外部文件变更触发编译时，如何通过编写插件来解决该问题。","title":"webpack 监听外部文件变更","tags":["webpack","plugin"]}}}}}