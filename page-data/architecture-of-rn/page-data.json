{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/architecture-of-rn/","result":{"data":{"site":{"siteMetadata":{"title":"学习随笔"}},"markdownRemark":{"id":"8b0a56dd-d559-5017-a1d9-70517fc27ec9","excerpt":"React Native 是一个能够允许 JavaScript 和 native 代码一样在 iOS 和 Android 设备上运行和交互的现代框架。它提供了一种编写一次多端运行的能力，有机会使我们统一应用的架构。对于新手而言了解 RN 是如何工作的比较让人困惑，因此本文将归结为理解以下三个架构： JavaScript…","html":"<p><strong>React Native</strong> 是一个能够允许 JavaScript 和 native 代码一样在 iOS 和 Android 设备上运行和交互的现代框架。它提供了一种编写一次多端运行的能力，有机会使我们统一应用的架构。对于新手而言了解 RN 是如何工作的比较让人困惑，因此本文将归结为理解以下三个架构：</p>\n<ol>\n<li>JavaScript 运行环境架构</li>\n<li>构建流程架构</li>\n<li>调试架构</li>\n</ol>\n<h3>JavaScript 运行环境架构（Bridge）</h3>\n<p>为了理解 RN 的原理，需要知道 javascript 在 iOS/Android 设备中是如何执行的。为了 javascript 的执行，react native 使用了称为 JavaScript Core 的运行环境，它其实是在操作系统上层的一些代码。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/cdd834927424eabe5afebf55416b7b91/28aaf/architecture-of-rn.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 84.22818791946308%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAIAAABSJhvpAAAACXBIWXMAAAsSAAALEgHS3X78AAAC4ElEQVQ4y42Q21MSYRjG16ausuwiyy6766r/wNNoiBwWCAVBscOVN9VYF3ZjNzXjlAKOOk5kVtNpyqZuMm3EdmUFtVREARHQVGiyRjxAKivIvr0LaacZ69tnvnne93t+37u7BPy1ZsPDE4vdrpDZFerZlnlisWuVXcBTDp/tRfxC/eh2+GrqRnINdpHeLkwJfd1wjmeZ5kNcYjf41fQ1g13Y4lA2OeSNY2SzQ4FeP1rkXWb+Db+crsVpSJqcFQ8mq5odp1ENo4L/h4t4ZlzZOq5qcih2g7mtraTiuMMW92Kq5taHvMYRsdEuMY6JjaMi9Dff53oWKQwn4rFUHq8hfv/T/HBqwfTYf/H5TM1Tb/UTz6Vn/ivoH/kvzK87/pyMd4Q9k6su56rblVJ40hNxT615fdFvGxsx2PzyNex0RzzeVbd7J7PicsbX14lYOGxRyt8VCyhJ8Y6wZEoUIa+fBfDfbu3Jz6FJ0c+AVNQrKECeiEUi/RoVLZP0yaW0VESTYt7IJFaNask/EweYbjOZC/L4Jh6hZBgQUyIBzk/CZaWIMeoSW2W5VadFgyXCC5PeFQ587W1MqXLgrM6mK+/Xai1lGou2glYo8StSk0tosphRY6ICeaZMiSU2Qz4fvrb37h30A+d1/bpyZ7UmeKMkcF01VyuPziZhRq2ipBKalFJiESUW0yRJkRJGpV6bm8df6jWZevLzaBlpLhL5L4sTHZWbHVWb9xSJz+NEPBIeOiezqk/ZtEKbJiWBVV04eEayNjMCwM601zPy7IEKIaMSfrxaGLsviD5URluzeZiLLbHdx9jX+9nODLbzIL93ZbFvMrHJDZ6AkZNx+ngUS2x2Hoq/PcD1pnPmdK5nH6zYCIiFoD8daAL60qCPAMseGMwEWwYMHQXbYbAegYEs3g9lgWUvH6MIoNOgl4AVCwGJDS7YwgUMXMC4rQYuoMcdgnoIGoD3+mTTAEFjUo0QqAf203czYeLt0NrnRQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"architecture of rn\"\n        title=\"architecture of rn\"\n        src=\"/static/cdd834927424eabe5afebf55416b7b91/799d3/architecture-of-rn.png\"\n        srcset=\"/static/cdd834927424eabe5afebf55416b7b91/00d96/architecture-of-rn.png 148w,\n/static/cdd834927424eabe5afebf55416b7b91/0b23c/architecture-of-rn.png 295w,\n/static/cdd834927424eabe5afebf55416b7b91/799d3/architecture-of-rn.png 590w,\n/static/cdd834927424eabe5afebf55416b7b91/2a3d6/architecture-of-rn.png 885w,\n/static/cdd834927424eabe5afebf55416b7b91/ae92f/architecture-of-rn.png 1180w,\n/static/cdd834927424eabe5afebf55416b7b91/28aaf/architecture-of-rn.png 1192w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>为了使 JavaScript 能够运行原生应用，必须仍然使用底层原生代码。从上图中，我们可以看到每个 RN 控件都会与对应的原生控件进行交互。RN 通过 bridge 来完成这两种方式的通信。所以原生代码实际上在它自己的线程操作，即如果 RN 的 JavaScript 代码执行了很长时间，并不会使 UI 卡住或者变慢。通过 bridge 传递事件来执行回调。</p>\n<h3>构建流程架构</h3>\n<p>在构建 react native 应用时，react native 做了下面两件事情：</p>\n<ul>\n<li>它在本地运行一个 node web 服务器，来发布一个持有所有我们 RN JavaScript 代码的 payload 文件</li>\n<li>然后它会构建一个原生的应用程序并部署到设备上。该程序中配置了拥有 JavaScript 运行环境，并下载之前生成好的 payload</li>\n<li>这个 payload 文件随后直接被传递到 JavaScript 运行环境，这样就拥有了原生容器和支撑运行整个应用程序的 JavaScript 代码</li>\n</ul>\n<h3>调试架构</h3>\n<p>对于调试 react native 应用程序的过程，我们需要做以下事情：</p>\n<ul>\n<li>设置源码的地址</li>\n<li>开启浏览器使调试器可以输出调试信息</li>\n<li>或者可以执行通过控制台打印日志来理解构建过程或调试程序</li>\n</ul>\n<p>React Native 开启了快速开发原型应用的篇章。许多基础的功能可以很轻松的实现。如果需要，它们可以通过原生代码和视图进行扩展，并且也可以与其他视图控制器进行集成。由于 RN 使用了 javascript，开发者可以更快更高效的工作，并且不需要每次更新代码后重启，可以直接刷新视图。</p>\n<h3>参考</h3>\n<p><a href=\"http://jyaasa.com/blog/getting-started-with-react-native-core-architecture-of-react-native\">http://jyaasa.com/blog/getting-started-with-react-native-core-architecture-of-react-native</a></p>","frontmatter":{"title":"初识 React Native 架构","date":"February 22, 2020","description":"对RN架构有一个整体的了解，原文章可能已过时但核心原理应该是不变的。"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"tags":["Architecture","React Native"],"slug":"/architecture-of-rn/","previous":null,"next":{"excerpt":"从理念上来说，Koa 意图“修复并取代 node”，而 Express 做的是“增强 node”。Koa 使用 promise 和 async 函数来摆脱回调地狱并简化异常处理逻辑。它暴露了自身的  和  对象而取代了 node 的  和  对象。 Express…","fields":{"slug":"/koa-vs-express/"},"frontmatter":{"date":"February 20, 2020","description":"Koa 与 Express 有哪些异同之处","title":"Koa 对比 Express","tags":["Koa","Express"]}}}}}